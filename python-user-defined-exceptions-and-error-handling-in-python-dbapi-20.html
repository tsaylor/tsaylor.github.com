<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Python User-Defined Exceptions and Error Handling in Python DbAPI 2.0 - Tim Saylor</title>
        <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/static/fetch.css?v=0b9d7">
        
            <link rel="alternate" type="application/rss+xml" href=" /feed" title="Tim Saylor">
        
        
    <link rel="canonical" href="/python-user-defined-exceptions-and-error-handling-in-python-dbapi-20">
    

    </head>
    <body>
        <header class="site-header">
            <nav class="buttons">
                
                    <a href="/" title="Home">
                        <i data-icon="h"></i>
                        <span class="text">Home</span>
                    </a>
                
                    <a href="https://twitter.com/tsaylor" title="Twitter">
                        <i data-icon="t"></i>
                        <span class="text">Twitter</span>
                    </a>
                
                    <a href="https://github.com/tsaylor" title="GitHub">
                        <i data-icon="g"></i>
                        <span class="text">GitHub</span>
                    </a>
                
            </nav>
            
        </header>

        <main><article>
        <header>
            <h1>Python User-Defined Exceptions and Error Handling in Python DbAPI 2.0</h1>
            <div class="meta">
                <time class="updated" datetime="2007-04-26T00:19:00+06:00" pubdate>April 26, 2007</time>
            </div>
        </header>

        <p>I just spent some time figuring out how to handle exceptions using the pysqlite library. I couldn&#39;t find a good description of how it works online, so I&#39;m making one.  </p>
<p>In python, all exceptions are classes. This means they can use any of the capabilities that regular python classes have, but generally all they do is define a few instance values in the <strong>init</strong> method. These values are available in the exception object (the instance of the exception class) when it is caught in a &ldquo;try &hellip; except&rdquo; block.  </p>
<p>If you&#39;re receiving a user defined exception from a foreign module and don&#39;t know how to handle it, I&#39;d recommend first wrapping the offending code in a &ldquo;try&hellip;except&rdquo; like this:  </p>

<blockquote>
<p><code>try:  
    c.execute(sql)  
except:  
    logfile.write(&quot;ERROR: %s %s %s&quot; % (sys.exc_info()[0], sys.exc_info()[1], sys.exc_info()[2]))</code></p>
</blockquote>
<p>The function <a href="http://docs.python.org/lib/module-sys.html">sys.exc_info()</a> returns a tuple containing 1) the type of exception being handled, 2) the associated parameter (usually some helpful descriptor), and 3) a traceback to where the exception occurred.  </p>
<p>This hopefully tells you two things: a description of why this happened, and more importantly for my situation, the exception type. When I ran that I got something like this:  </p>

<blockquote>
<p><code>ERROR: &lt;class &#39;pysqlite2.dbapi2.OperationalError&#39;&gt; table something already exists &lt;traceback object at 0xb7da3cd4&gt;</code></p>
</blockquote>
<p>So the exception being raised was at pysqlite2.dbapi2.OperationalError. Since the python dbapi returns sql errors through exceptions I can&#39;t just fix the code here, I have to &ldquo;try &hellip; except&rdquo; it. Here&#39;s what the final code snippet looked like:  </p>

<blockquote>
<p><code>try:  
    c.execute(sql)  
except pysqlite2.dbapi2.OperationalError, msg:  
    logfile.write(&quot;ERROR: %s&quot; % msg)</code></p>
</blockquote>
<p>To catch the other exceptions specified in the dbapi v2.0, you&#39;d have to include several more exception handlers. The other exception classes are in the same location as the OperationalError class.  </p>
<p>Further reading: </p>

<ul>
<li><a href="http://www.python.org/doc/current/tut/node10.html#SECTION0010500000000000000000">User-Defined Exceptions</a></li>
<li><a href="http://www.python.org/dev/peps/pep-0249/">Python Database API Specification v2.0</a></li>
</ul>

<h2 id="toc_0">Comments</h2>
<p><strong><a href="#4" title="2011-02-03 13:30:35">Blub</a>:</strong> Thanks! This help me really out.</p>


    </article>
</main>
        <footer class="site-footer">
            <p>&copy; Tim Saylor.
            <br>Powered by <a href="http://lab.lepture.com/liquidluck/">Felix Felicis</a>
            <br>Theme based on <a href="https://github.com/roryg/ghostwriter">ghostwriter</a> by <a href="http://jollygoodthemes.com">JollyGoodThemes</a>, by way of <a href="https://github.com/kennethlove/alex-gaynor-blog-design">Kenneth Love</a>.</p>
        </footer>
    </body>
</html>