<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>That&#39;s the last time I trust Ubuntu to upgrade correctly - Felix Felicis</title>
        <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/static/fetch.css?v=0b9d7">
        
            <link rel="alternate" type="application/rss+xml" href=" /feed.xml" title="Felix Felicis">
        
        
    <link rel="canonical" href="/2010/thats-the-last-time-i-trust-ubuntu-to-upgrade-correctly.html">
    

    </head>
    <body>
        <header class="site-header">
            <nav class="buttons">
                
                    <a href="/" title="Home">
                        <i data-icon="h"></i>
                        <span class="text">Home</span>
                    </a>
                
                    <a href="https://twitter.com/tsaylor" title="Twitter">
                        <i data-icon="t"></i>
                        <span class="text">Twitter</span>
                    </a>
                
                    <a href="https://github.com/tsaylor" title="GitHub">
                        <i data-icon="g"></i>
                        <span class="text">GitHub</span>
                    </a>
                
            </nav>
            
        </header>

        <main><article>
        <header>
            <h1>That&#39;s the last time I trust Ubuntu to upgrade correctly</h1>
            <div class="meta">
                <time class="updated" datetime="2010-12-08T18:18:37+08:00" pubdate>December 08, 2010</time>
            </div>
        </header>

        <p>I host <a href="http://www.barcampchicago.com/">Barcamp Chicago&#39;s website</a>.  It&#39;s a custom Django site on Ubuntu.  I recently upgraded the server to the latest LTS and later discovered my Postgresql database was gone.  Postgresql had gone from 8.3 to 8.4 in the upgrade, but since it didn&#39;t warn me about needing to migrate the data I assumed it took care of that.  That was a mistake.  I had three databases on Postgresql 8.3 and none of them were present anymore.  I read on a forum that I could reinstall 8.3, but that person was working from Karmic not Lucid like I had.  I ultimately had to: </p>

<ol>
<li>add the Karmic repositories to apt,</li>
<li>shut down 8.4,</li>
<li>install 8.3,</li>
<li>go through the normal data dump procedure for upgrading Postgresql manually,</li>
<li>uninstall 8.3,</li>
<li>start 8.4,</li>
<li>and load all the data again.</li>
</ol>
<p>After that the CLI showed my databases were present so I relaunched the barcamp site, but it still wasn&#39;t connecting.  A little more googling revealed that Postgresql likes to increment the port number it listens on when there are two versions installed on the same machine.  That was indeed the problem, so I changed the port number back, restarted it and Apache, and finally I&#39;m back to where I started. I should have known better than to trust Ubuntu to migrate the data, but even if I did that myself I&#39;d never expect a minor version upgrade to listen on a different port when that upgrade disables the old version anyway.</p>


    </article>
</main>
        <footer class="site-footer">
            <p>&copy; Tim Saylor.
            <br>Powered by <a href="http://lab.lepture.com/liquidluck/">Felix Felicis</a>
            <br>Theme based on <a href="https://github.com/roryg/ghostwriter">ghostwriter</a> by <a href="http://jollygoodthemes.com">JollyGoodThemes</a>, by way of <a href="https://github.com/kennethlove/alex-gaynor-blog-design">Kenneth Love</a>.</p>
        </footer>
    </body>
</html>