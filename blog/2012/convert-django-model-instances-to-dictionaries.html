<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Convert Django Model Instances To Dictionaries - Felix Felicis</title>
        <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/static/fetch.css?v=0b9d7">
        
            <link rel="alternate" type="application/rss+xml" href=" /feed.xml" title="Felix Felicis">
        
        
    <link rel="canonical" href="/2012/convert-django-model-instances-to-dictionaries.html">
    

    </head>
    <body>
        <header class="site-header">
            <nav class="buttons">
                
                    <a href="/" title="Home">
                        <i data-icon="h"></i>
                        <span class="text">Home</span>
                    </a>
                
                    <a href="https://twitter.com/tsaylor" title="Twitter">
                        <i data-icon="t"></i>
                        <span class="text">Twitter</span>
                    </a>
                
                    <a href="https://github.com/tsaylor" title="GitHub">
                        <i data-icon="g"></i>
                        <span class="text">GitHub</span>
                    </a>
                
            </nav>
            
        </header>

        <main><article>
        <header>
            <h1>Convert Django Model Instances To Dictionaries</h1>
            <div class="meta">
                <time class="updated" datetime="2012-05-21T20:56:47+08:00" pubdate>May 21, 2012</time>
            </div>
        </header>

        <p>I just searched for a method to convert a model instance to a dictionary in Django and the top few results were a bunch of custom methods in Django Snippets and Stack Overflow.  I was about to use one of those when I clicked on one last link that showed me <a href="https://yuji.wordpress.com/2008/11/21/django-quick-note-from-irc-model-instance-to-dictionary/">a better solution</a>.  There is a method already built into Django that does exactly what I want: <a href="https://github.com/django/django/blob/master/django/forms/models.py#L95">django.forms.models.model_to_dict</a>.</p>
<p>As I pointed that out to a coworker, he showed me that that&#39;s basically the same output as <a href="https://docs.djangoproject.com/en/dev/ref/models/querysets/#values">the .values() method in the queryset api.</a>  If you don&#39;t specify a value to retrieve, it will retrieve the whole model instance as a dictionary. </p>
<p>Here&#39;s the output of these two pieces of code: </p>

<pre><code>&gt;&gt;&gt; Q.objects.filter(id=6).values()
[{'short': u'oui', 'deleted': False, 'language_id': 3L, 'long': u'oui', 'place_holder': u'oui', 'id': 6L, 'question_id': 8L}]
&gt;&gt;&gt; model_to_dict(Q.objects.filter(id=6)[0])
{'short': u'oui', 'language': 3L, 'deleted': False, 'question': 8L, 'long': u'oui', 'place_holder': u'oui'}</code></pre>
<p>There are two differences here, and one of them is pretty important.  First, .values() turns a queryset into an iterable that yields dictionaries, and model_to_dict turns a model instance into a single dictionary.  As long as you know about it this is pretty trivial to overcome.  Second, .values() converts foreign keys to {&#39;<field_name>_id&#39;: #} and model_to_dict converts them to {&#39;<field_name>&#39;: #}.  Since my purpose in using this was to populate a form I had to convert the id&#39;s into model instances and update the dictionary.  Not a big problem, but a bigger annoyance to solve than the first difference.</p>

<h2 id="toc_0">Comments</h2>
<p><strong><a href="#30" title="2013-03-14 15:19:47">ray</a>:</strong> Thanks for this. Saved me a lot of work I was about to get into.</p>
<p><strong><a href="#31" title="2013-07-24 14:29:09">jorgwel</a>:</strong> Hi, thaks for this info. Another difference between the two ways you mention, is that &ldquo;model_to_dict&rdquo; do returns details about ManyToMany fields, and &ldquo;.values()&rdquo; doesn&#39;t.</p>
<p><strong><a href="#32" title="2015-01-27 07:32:57">Vinay Kotian</a>:</strong> Hello, Thank you for the solution which has indeed helped. But now I am in a situation where i need all the dictionary from the queryset to be converted to string form rather than in unicode format({u&#39;abc&#39;: #}). Please let me know a solution thank you.</p>
<p><strong><a href="#33" title="2015-03-01 11:07:30">tsaylor</a>:</strong> You should use the json library to convert your dictionary to a json string.</p>


    </article>
</main>
        <footer class="site-footer">
            <p>&copy; Tim Saylor.
            <br>Powered by <a href="http://lab.lepture.com/liquidluck/">Felix Felicis</a>
            <br>Theme based on <a href="https://github.com/roryg/ghostwriter">ghostwriter</a> by <a href="http://jollygoodthemes.com">JollyGoodThemes</a>, by way of <a href="https://github.com/kennethlove/alex-gaynor-blog-design">Kenneth Love</a>.</p>
        </footer>
    </body>
</html>